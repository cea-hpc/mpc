<?xml version="1.0" encoding="ISO-8859-1"?>
<!--
############################# MPC License ##############################
# Wed Nov 19 15:19:19 CET 2008                                         #
# Copyright or (C) or Copr. Commissariat a l'Energie Atomique          #
#                                                                      #
# IDDN.FR.001.230040.000.S.P.2007.000.10000                            #
# This file is part of the MPC Runtime.                                #
#                                                                      #
# This software is governed by the CeCILL-C license under French law   #
# and abiding by the rules of distribution of free software.  You can  #
# use, modify and/ or redistribute the software under the terms of     #
# the CeCILL-C license as circulated by CEA, CNRS and INRIA at the     #
# following URL http://www.cecill.info.                                #
#                                                                      #
# The fact that you are presently reading this means that you have     #
# had knowledge of the CeCILL-C license and that you accept its        #
# terms.                                                               #
#                                                                      #
# Authors:                                                             #
#   - VALAT Sebastien sebastien.valat@cea.fr                           #
#   - BESNARD Jean-Baptiste jbbesnard@paratools.fr                     #
#                                                                      #
########################################################################
-->

<mpc xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="mpc-config.xsd">
	<profiles>
		<profile>
			<name>default</name>
			<modules>
			</modules>
			<networks>
				<!-- net config contain complexe structures so default value cannot be setup into config-meta.xml -->
				<configs>
					<config>
						<name>ib_config_mpi</name>
						<driver>
							<infiniband>
								<network_type>1</network_type>
							</infiniband>
						</driver>
					</config>
					<config>
						<name>ib_config_signalization</name>
						<driver>
							<infiniband>
								<network_type>0</network_type>
								<qp_tx_depth>1000</qp_tx_depth>
								<cq_depth>2000</cq_depth>
								<init_ibufs>100</init_ibufs>
								<init_recv_ibufs>20</init_recv_ibufs>
								<max_srq_ibufs_posted>100</max_srq_ibufs_posted>
								<max_srq_ibufs>100</max_srq_ibufs>
								<srq_credit_limit>100</srq_credit_limit>
								<init_mr>10</init_mr>
								<size_mr_chunk>10</size_mr_chunk>
								<mmu_cache_enabled>0</mmu_cache_enabled>
								<mmu_cache_entries>0</mmu_cache_entries>
								<steal>0</steal>
								<rdma_min_size>0</rdma_min_size>
								<rdma_max_size>0</rdma_max_size>
								<rdma_min_nb>0</rdma_min_nb>
								<rdma_max_nb>0</rdma_max_nb>
								<rdma_resizing_min_size>0</rdma_resizing_min_size>
								<rdma_resizing_max_size>0</rdma_resizing_max_size>
								<rdma_resizing_min_nb>0</rdma_resizing_min_nb>
								<rdma_resizing_max_nb>0</rdma_resizing_max_nb>
								<size_recv_ibufs_chunk>50</size_recv_ibufs_chunk>
							</infiniband>
						</driver>
						
					</config>
						
					<config>
						<name>tcp_config_mpi</name>
						<driver>
							<tcp/>
						</driver>
					</config>
				         
				</configs>

				<rails>
					<rail>
						<name>ib_mpi</name>
						<device>0</device>
						<topology>ondemand</topology>
						<config>ib_config_mpi</config>
					</rail>
					<rail>
						<name>ib_signalization</name>
						<device>0</device>
						<topology>torus</topology>
						<config>ib_config_signalization</config>
					</rail>
					<rail>
						<name>tcp_mpi</name>
						<priority>1</priority>
						<device>0</device>
						<topology>fully</topology>
						<config>tcp_config_mpi</config>
					</rail>
					<rail>
						<name>tcp_large</name>
						<priority>10</priority>
						<device>0</device>
						<topology>fully</topology>
						<config>tcp_config_mpi</config>
						<gates>
							<gate>
								<minsize>
									<value>32KB</value>
								</minsize>
							</gate>
						</gates>
					</rail>
					<rail>
						<name>tcp_mpi_ring</name>
						<device>0</device>
						<topology>ring</topology>
						<config>tcp_config_mpi</config>
					</rail>
				</rails>

				<cli_options>
					<cli_option>
						<name>ib</name>
						<rails>
							<rail>ib_mpi</rail>
							<rail>ib_signalization</rail>
						</rails>
					</cli_option>
					<cli_option>
						<name>tcp</name>
						<rails>
							<rail>tcp_mpi</rail>
						</rails>
					</cli_option>
					<cli_option>
						<name>multirail_tcp</name>
						<rails>
							<rail>tcp_large</rail>
							<rail>tcp_mpi</rail>
						</rails>
					</cli_option>
					<cli_option>
						<name>default</name>
						<rails>
							<rail>ib_mpi</rail>
							<rail>ib_signalization</rail>
						</rails>
					</cli_option>
				</cli_options>
			</networks>
		</profile>
	</profiles>
</mpc>
