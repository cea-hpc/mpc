<?xml version="1.0" encoding="ISO-8859-1"?>
<!--
############################# MPC License ##############################
# Wed Nov 19 15:19:19 CET 2008                                         #
# Copyright or (C) or Copr. Commissariat a l'Energie Atomique          #
#                                                                      #
# IDDN.FR.001.230040.000.S.P.2007.000.10000                            #
# This file is part of the MPC Runtime.                                #
#                                                                      #
# This software is governed by the CeCILL-C license under French law   #
# and abiding by the rules of distribution of free software.  You can  #
# use, modify and/ or redistribute the software under the terms of     #
# the CeCILL-C license as circulated by CEA, CNRS and INRIA at the     #
# following URL http://www.cecill.info.                                #
#                                                                      #
# The fact that you are presently reading this means that you have     #
# had knowledge of the CeCILL-C license and that you accept its        #
# terms.                                                               #
#                                                                      #
# Authors:                                                             #
#   - VALAT Sebastien sebastien.valat@cea.fr                           #
#                                                                      #
########################################################################
-->

<!--
This file contain the default values to override when generating the final file to place into
{INSTALL_PREFIX}/share/mpc/config.xml.example

PLEASE, setup only complexe structure here, for simple values de default will be taken from
config-meta.xml automatically.
-->

<mpc xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="mpc-config.xsd">
	<profiles>
		<profile>
			<name>default</name>
			<modules>
			</modules>
			<networks>
				<!-- net config contain complexe structures so default value cannot be setup into config-meta.xml -->
				<configs>
					<config>
						<name>ib_config_mpi</name>
						<driver>
              <infiniband>
                <network_type>1</network_type>
                <adm_port>1</adm_port>
                <verbose_level>0</verbose_level>
                <eager_limit>12288</eager_limit>
                <buffered_limit>262114</buffered_limit>
                <qp_tx_depth>15000</qp_tx_depth>
                <qp_rx_depth>0</qp_rx_depth>
                <cq_depth>40000</cq_depth>
                <max_sg_sq>4</max_sg_sq>
                <max_sg_rq>4</max_sg_rq>
                <max_inline>128</max_inline>
                <wc_in_number>4</wc_in_number>
                <wc_out_number>4</wc_out_number>
                <rdma_depth>4</rdma_depth>
                <rdma_dest_depth>4</rdma_dest_depth>
                <rdma_resizing>0</rdma_resizing>
                <max_rdma_connections>0</max_rdma_connections>
                <max_rdma_resizing>0</max_rdma_resizing>
                <init_ibufs>1000</init_ibufs>
                <max_srq_ibufs_posted>1500</max_srq_ibufs_posted>
                <max_srq_ibufs>1000</max_srq_ibufs>
                <srq_credit_limit>500</srq_credit_limit>
                <srq_credit_thread_limit>100</srq_credit_thread_limit>
                <size_ibufs_chunk>2000</size_ibufs_chunk>
                <init_mr>400</init_mr>
                <size_mr_chunk>200</size_mr_chunk>
                <mmu_cache_enabled>0</mmu_cache_enabled>
                <mmu_cache_entries>200</mmu_cache_entries>
                <steal>1</steal>
                <quiet_crash>0</quiet_crash>
                <async_thread>1</async_thread>
							</infiniband>
						</driver>
					</config>
					<config>
						<name>ib_config_signalization</name>
						<driver>
              <infiniband>
                <network_type>0</network_type>
                <adm_port>1</adm_port>
                <verbose_level>0</verbose_level>
                <eager_limit>12288</eager_limit>
                <buffered_limit>262114</buffered_limit>
                <qp_tx_depth>1000</qp_tx_depth>
                <qp_rx_depth>0</qp_rx_depth>
                <cq_depth>2000</cq_depth>
                <max_sg_sq>4</max_sg_sq>
                <max_sg_rq>4</max_sg_rq>
                <max_inline>128</max_inline>
                <wc_in_number>4</wc_in_number>
                <wc_out_number>4</wc_out_number>
                <rdma_depth>4</rdma_depth>
                <rdma_dest_depth>4</rdma_dest_depth>
                <rdma_resizing>0</rdma_resizing>
                <max_rdma_connections>0</max_rdma_connections>
                <max_rdma_resizing>0</max_rdma_resizing>
                <init_ibufs>100</init_ibufs>
                <max_srq_ibufs_posted>100</max_srq_ibufs_posted>
                <max_srq_ibufs>100</max_srq_ibufs>
                <srq_credit_limit>100</srq_credit_limit>
                <srq_credit_thread_limit>100</srq_credit_thread_limit>
                <size_ibufs_chunk>100</size_ibufs_chunk>
                <init_mr>10</init_mr>
                <size_mr_chunk>10</size_mr_chunk>
                <mmu_cache_enabled>0</mmu_cache_enabled>
                <mmu_cache_entries>0</mmu_cache_entries>
                <steal>0</steal>
                <quiet_crash>0</quiet_crash>
                <async_thread>1</async_thread>
              </infiniband>
            </driver>
          </config>
          <config>
            <name>tcp_config_mpi</name>
            <driver>
              <tcp>
                <fake_param>0</fake_param>
              </tcp>
            </driver>
          </config>
          <config>
            <name>tcpoib_config_mpi</name>
            <driver>
              <tcpoib>
                <fake_param>0</fake_param>
              </tcpoib>
            </driver>
          </config>
				</configs>
				<!-- rails contain complexe structures so default value cannot be setup into config-meta.xml -->
        <rails>
					<rail>
						<name>ib_mpi</name>
						<device>0</device>
						<topology>ondemand</topology>
						<config>ib_config_mpi</config>
					</rail>
					<rail>
						<name>ib_signalization</name>
						<device>0</device>
						<topology>torus</topology>
						<config>ib_config_signalization</config>
          </rail>
					<rail>
						<name>tcp_mpi</name>
						<device>0</device>
						<topology>fully</topology>
						<config>tcp_config_mpi</config>
          </rail>
					<rail>
						<name>tcpoib_mpi</name>
						<device>0</device>
						<topology>fully</topology>
						<config>tcpoib_config_mpi</config>
          </rail>
        </rails>

        <cli_options>
          <cli_option>
            <name>ib</name>
            <rails>
              <rail>ib_mpi</rail>
              <rail>ib_signalization</rail>
            </rails>
          </cli_option>
          <cli_option>
            <name>tcp</name>
            <rails>
              <rail>tcp_mpi</rail>
            </rails>
          </cli_option>
          <cli_option>
            <name>tcpoib</name>
            <rails>
              <rail>tcpoib_mpi</rail>
            </rails>
          </cli_option>
          <cli_option>
            <name>multirail_tcp</name>
            <rails>
              <rail>tcp_mpi</rail>
              <rail>tcp_mpi</rail>
            </rails>
          </cli_option>
          <cli_option>
            <name>default</name>
            <rails>
              <rail>ib_mpi</rail>
              <rail>ib_signalization</rail>
            </rails>
          </cli_option>
        </cli_options>
			</networks>
		</profile>
	</profiles>
</mpc>
